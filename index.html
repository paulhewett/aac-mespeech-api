<!DOCTYPE html>
<html>
<head>
<script>
    
function test() {
    
    alert("HEllo there");
}    
    
function authUser() {

    alert("Hola, looking good!");
    
    xmlToSubmit = "<user>";
    xmlToSubmit += "<username>" + document.getElementById('username').value + "</username>";
    xmlToSubmit += "<password>" + document.getElementById('password').value + "</password>";
    xmlToSubmit += "</user>";

    $.ajax({
        //cache: false,
        //crossDomain: true,
        //async: false,
        headers: {
            'apikey': 'asdqwe123'
        },
	contentType: 'text/plain',
        url: 'https://mespee.ch/api/auth',
        type: 'POST',
        data: {
            data: xmlToSubmit
        },
        success: function (xml) {
            //Retrieve user token
            var token = $(xml).find('token').text(); // Store token for subsequent requests
            var user = $(xml).find('id').text(); // Store token for subsequent requests

            console.log("Token is " + token + " for user " + user);

            //Store user token and userid
            //localStorage["msp_token"] = token;
            //localStorage["msp_userid"] = $(xml).find('id').text();

            //Set default symbolset
            //  alert("Symbolset is " + $(xml).find('default_symbolset').text());

            switch ($(xml).find('default_symbolset').text()) {

                case "1":
                    preferredSs = "ss";
                    break;
                case "2":
                    preferredSs = "wi"
                    break;
                case "3":
                    preferredSs = "me"
                    break;
                case "4":
                    preferredSs = "mu"
                    break;

            }

            console.log("Signed in");
            redirectPage("/pages/options/options.html");

        },
        error: function (xhr) {
            console.log("There was an error");
            xml = xhr.responseXML;
            $(xml).find('error').each(function () {
                console.log("Your username or password were incorrect, please try again.")
            });
        }
    });
}    
    
    
</script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<title>Sign In</title>
</head>
<body>
Updated
<div id="signin">
    <div id="content">
        <a href="http://mespeech.com"><img src="/images/mespeech_logo_150px.png" /></a>
        <p>You need to sign in to access your online <br />content. You will only need to do this once.</p>
        <input id="username" type="text" value="Username" /><br />
        <input id="password" type="password" value="Password" /><br />
	    <button id="authenticate" onclick="authUser()">Sign In</button>
    </div>
</div>
</body>
</html>
